<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Rapide Galligeo</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background-color: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .console { background-color: #000; color: #00ff00; padding: 15px; font-family: monospace; max-height: 400px; overflow-y: auto; }
    </style>
</head>
<body>
    <h1>üß™ Test Rapide des Corrections Galligeo</h1>
    <button onclick="runQuickTests()">‚ñ∂Ô∏è Lancer les tests</button>
    <button onclick="clearConsole()">üóëÔ∏è Effacer</button>
    
    <div id="console" class="console">
        Pr√™t pour les tests...
    </div>

    <!-- Chargement des scripts de test -->
    <script src="config/test-config.js"></script>
    <script src="config/test-utils.js"></script>
    <script src="frontend/georeferencing-interface-tests.js"></script>
    <script src="frontend/authentication-tests.js"></script>
    <script src="frontend/settings-manager-tests.js"></script>

    <script>
        function log(level, message) {
            const console = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            const className = level === 'error' ? 'error' : level === 'success' ? 'success' : 'info';
            console.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }

        function clearConsole() {
            document.getElementById('console').innerHTML = 'Console effac√©e...';
        }

        async function runQuickTests() {
            log('info', 'üöÄ D√©but des tests rapides');
            
            try {
                // Test 1: V√©rification de la configuration
                log('info', 'üìã Test de la configuration...');
                if (window.GALLIGEO_TEST_CONFIG) {
                    log('success', '‚úÖ Configuration charg√©e');
                    if (window.GALLIGEO_TEST_CONFIG.SELECTORS) {
                        log('success', '‚úÖ S√©lecteurs disponibles');
                        log('info', `ARK Input: ${window.GALLIGEO_TEST_CONFIG.SELECTORS.arkInput}`);
                    } else {
                        log('error', '‚ùå S√©lecteurs manquants');
                    }
                } else {
                    log('error', '‚ùå Configuration non charg√©e');
                    return;
                }

                // Test 2: Tests de g√©or√©f√©rencement
                log('info', 'üé® Test des classes de test...');
                if (typeof GeoreferencingInterfaceTests !== 'undefined') {
                    log('success', '‚úÖ GeoreferencingInterfaceTests disponible');
                    
                    const geoTests = new GeoreferencingInterfaceTests();
                    log('info', 'üìù Ex√©cution d\'un test simple...');
                    
                    // Test de base sans √©l√©ments DOM
                    try {
                        // Simuler la pr√©sence de l'√©l√©ment ARK input
                        const mockInput = document.createElement('input');
                        mockInput.id = 'search-784-input';
                        mockInput.type = 'text';
                        document.body.appendChild(mockInput);
                        
                        await geoTests.testPageLoad();
                        log('success', '‚úÖ Test de chargement r√©ussi');
                        
                        document.body.removeChild(mockInput);
                    } catch (error) {
                        log('error', '‚ùå Erreur test g√©or√©f√©rencement: ' + error.message);
                    }
                } else {
                    log('error', '‚ùå GeoreferencingInterfaceTests non disponible');
                }

                // Test 3: Tests d'authentification  
                if (typeof AuthenticationTests !== 'undefined') {
                    log('success', '‚úÖ AuthenticationTests disponible');
                    
                    const authTests = new AuthenticationTests();
                    try {
                        await authTests.testAuthModuleInitialization();
                        log('success', '‚úÖ Test d\'authentification r√©ussi (avec mock)');
                    } catch (error) {
                        log('error', '‚ùå Erreur test authentification: ' + error.message);
                    }
                } else {
                    log('error', '‚ùå AuthenticationTests non disponible');
                }

                // Test 4: Tests de param√®tres
                if (typeof SettingsManagerTests !== 'undefined') {
                    log('success', '‚úÖ SettingsManagerTests disponible');
                    
                    const settingsTests = new SettingsManagerTests();
                    try {
                        await settingsTests.testSettingsManagerInitialization();
                        log('success', '‚úÖ Test de param√®tres r√©ussi (avec mock)');
                    } catch (error) {
                        log('error', '‚ùå Erreur test param√®tres: ' + error.message);
                    }
                } else {
                    log('error', '‚ùå SettingsManagerTests non disponible');
                }

                log('success', 'üéâ Tests rapides termin√©s');
                
            } catch (error) {
                log('error', 'üí• Erreur g√©n√©rale: ' + error.message);
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            log('info', 'üîß Interface de test pr√™te');
            log('info', 'Cliquez sur "Lancer les tests" pour commencer');
        });
    </script>
</body>
</html>
